import"./Dw8DVmwd.js";import{r as v,x as C,v as u}from"#entry";const E=()=>{const c="blogBookmarks",t=v([]),l=v(!1),m=()=>{if(typeof window<"u")try{const e=localStorage.getItem(c);if(e){const o=JSON.parse(e);Array.isArray(o)&&(t.value=o.map(r=>({"url-slug":r["url-slug"],title:r.title,"first-published-on":r["first-published-on"],categories:r.categories||[],tags:r.tags||[],"post-format":r["post-format"]||{name:"Standard","url-slug":"standard"},excerpt:r.excerpt||"","reading-time":r["reading-time"]||{minutes:1,text:"1 min read"},bookmarkedAt:r.bookmarkedAt||new Date().toISOString(),authors:r.authors||[]})))}l.value=!0}catch(e){console.warn("Failed to load bookmarks from localStorage:",e),t.value=[],l.value=!0}},d=()=>{if(typeof window<"u")try{localStorage.setItem(c,JSON.stringify(t.value))}catch(e){console.warn("Failed to save bookmarks to localStorage:",e)}};C(t,d,{deep:!0});const i=e=>!e||!e["url-slug"]?!1:t.value.some(o=>o["url-slug"]===e["url-slug"]&&o["first-published-on"]===e["first-published-on"]),f=e=>{if(!e||!e["url-slug"])return console.warn("Invalid post data for bookmark"),!1;if(i(e))return!1;const o={"url-slug":e["url-slug"],title:e.title,"first-published-on":e["first-published-on"],categories:e.categories||[],tags:e.tags||[],"post-format":e["post-format"]||{name:"Standard","url-slug":"standard"},excerpt:e.excerpt||"","reading-time":e["reading-time"]||{minutes:1,text:"1 min read"},authors:e.authors||[],bookmarkedAt:new Date().toISOString()};return t.value.unshift(o),!0},g=e=>{if(!e||!e["url-slug"])return!1;const o=t.value.findIndex(r=>r["url-slug"]===e["url-slug"]&&r["first-published-on"]===e["first-published-on"]);return o>-1?(t.value.splice(o,1),!0):!1},k=e=>i(e)?g(e):f(e),h=()=>t.value,p=()=>{t.value=[]},w=u(()=>t.value.length),B=u(()=>t.value.sort((e,o)=>new Date(o.bookmarkedAt)-new Date(e.bookmarkedAt)).slice(0,5)),S=e=>{if(!e||e.trim()==="")return t.value;const o=e.toLowerCase();return t.value.filter(r=>r.title.toLowerCase().includes(o)||r.excerpt.toLowerCase().includes(o)||r.categories.some(s=>s.name.toLowerCase().includes(o))||r.tags.some(s=>s.name.toLowerCase().includes(o)))},b=e=>e?t.value.filter(o=>o.categories.some(r=>r["url-slug"]===e)):t.value,x=e=>e?t.value.filter(o=>o.tags.some(r=>r["url-slug"]===e)):t.value,y=()=>{const e={version:"1.0",exportedAt:new Date().toISOString(),count:t.value.length,bookmarks:t.value};return JSON.stringify(e,null,2)},A=(e,o=!0)=>{try{const r=JSON.parse(e);if(!r.bookmarks||!Array.isArray(r.bookmarks))throw new Error("Invalid bookmark data format");if(o){const s=new Set(t.value.map(a=>`${a["url-slug"]}-${a["first-published-on"]}`)),n=r.bookmarks.filter(a=>!s.has(`${a["url-slug"]}-${a["first-published-on"]}`));t.value=[...t.value,...n]}else t.value=r.bookmarks;return{success:!0,imported:r.bookmarks.length,total:t.value.length}}catch(r){return console.error("Failed to import bookmarks:",r),{success:!1,error:r.message}}},O=()=>{const e={},o={},r={};return t.value.forEach(s=>{s.categories.forEach(a=>{e[a.name]=(e[a.name]||0)+1}),s.tags.forEach(a=>{o[a.name]=(o[a.name]||0)+1});const n=s["post-format"]?.name||"Standard";r[n]=(r[n]||0)+1}),{total:t.value.length,categories:Object.entries(e).map(([s,n])=>({name:s,count:n})),tags:Object.entries(o).map(([s,n])=>({name:s,count:n})),formats:Object.entries(r).map(([s,n])=>({name:s,count:n}))}};return l.value||m(),{bookmarks:u(()=>t.value),bookmarkCount:w,recentBookmarks:B,isLoaded:u(()=>l.value),isBookmarked:i,addBookmark:f,removeBookmark:g,toggleBookmark:k,getBookmarks:h,clearBookmarks:p,searchBookmarks:S,filterByCategory:b,filterByTag:x,exportBookmarks:y,importBookmarks:A,getBookmarkStats:O,loadBookmarks:m,saveBookmarks:d}};export{E as u};
